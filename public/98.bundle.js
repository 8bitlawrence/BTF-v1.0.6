(self.webpackChunkbtf_v1_0_6=self.webpackChunkbtf_v1_0_6||[]).push([[98],{98:()=>{let e,t,n,s,o,i,l,c,a,d,r=null,p=[],m=null;function u(){"undefined"!=typeof coinsEl&&coinsEl&&(coinsEl.textContent=state.coins),e&&(e.textContent=state.enchantPoints),f()}function y(e){const t=PETS.find(t=>t.id===e);return t?t.name:e}function h(e){const t=PETS.find(t=>t.id===e);return t?t.rarity:"common"}function f(){if(t.innerHTML="",0!==Object.keys(state.inventory).length)for(const[e,n]of Object.entries(state.inventory)){const s=document.createElement("div");s.className="pet-card",r&&r.startsWith(e+"_")&&s.classList.add("selected");const o=y(e),i=h(e);s.innerHTML=`\n            <div style="font-size:32px">üêæ</div>\n            <div class="pet-name">${o}</div>\n            <div class="pet-rarity rarity-${i}">${i}</div>\n            <div style="font-size:12px;margin-top:4px;color:var(--muted)">x${n}</div>\n        `,s.addEventListener("click",()=>v(e,n)),t.appendChild(s)}else t.innerHTML='<p style="color:var(--muted);text-align:center;padding:40px;grid-column:1/-1">No pets in inventory</p>'}function v(e,t){m=e;const n=y(e);a.textContent=`Select ${n} to Enchant`,d.innerHTML="";for(let s=0;s<t;s++){const t=`${e}_${s}`,o=state.petEnchantments[t]||[],i=document.createElement("div");i.className="pet-instance-item";let l="No enchantments";o.length>0&&(l=`<strong>Enchantments:</strong> ${o.map(e=>{const t=ENCHANTMENTS.find(t=>t.id===e);return t?t.name:e}).join(", ")}`),i.innerHTML=`\n            <div style="font-weight:700;font-size:15px;margin-bottom:4px">${n} #${s+1}</div>\n            <div style="font-size:13px;color:var(--muted)">${l}</div>\n        `,i.addEventListener("click",()=>{g(t,e),E()}),d.appendChild(i)}l.classList.add("show")}function E(){l.classList.remove("show")}function g(e,t){r=e,f(),n.style.display="block",s.textContent=y(t);const i=state.petEnchantments[e]||[];if(0===i.length)o.textContent="No enchantments yet";else{const e=i.map(e=>{const t=ENCHANTMENTS.find(t=>t.id===e);return t?t.name:e}).join(", ");o.innerHTML=`<strong>Enchantments:</strong> ${e}`}x()}function x(){p=[];const e=r?r.split("_").slice(0,-1).join("_"):null,t=[...ENCHANTMENTS.filter(t=>!t.exclusiveTo||t.exclusiveTo===e)];for(let e=0;e<3&&t.length>0;e++){const e=Math.floor(Math.random()*t.length);p.push(t[e]),t.splice(e,1)}!function(){if(i.innerHTML="",0===p.length)return void(i.innerHTML='<p style="color:var(--muted);text-align:center;padding:40px">No options available</p>');p.forEach(e=>{const t=document.createElement("div");t.className="enchant-option",t.innerHTML=`\n            <div class="enchant-name">\n                ${e.name}\n                <span class="tier-badge tier-${e.tier}">Tier ${e.tier}</span>\n            </div>\n            <div class="enchant-desc">${e.description}</div>\n            <div class="enchant-cost">üíé ${e.cost} Enchantment Points</div>\n        `,t.addEventListener("click",()=>function(e){if(!r)return void b("Please select a pet first");if(state.enchantPoints<e.cost)return void b(`Not enough Enchantment Points! You need ${e.cost} EP but only have ${state.enchantPoints} EP.`);if((state.petEnchantments[r]||[]).includes(e.id))return void b("This pet already has this enchantment!");state.enchantPoints-=e.cost,state.petEnchantments[r]||(state.petEnchantments[r]=[]),state.petEnchantments[r].push(e.id),saveState(),u();const t=r.split("_").slice(0,-1).join("_");g(r,t),b(`Successfully enchanted with ${e.name}!`)}(e)),i.appendChild(t)});const e=state.petRerollsUsed[r]||0,t=0===e,n=document.createElement("button");t?(n.textContent="üîÑ Reroll Options (1 Free Reroll)",n.className="muted"):(n.textContent="üîÑ Reroll Options (20 EP)",n.className="muted",state.enchantPoints<20&&(n.disabled=!0,n.style.opacity="0.5",n.style.cursor="not-allowed")),n.style.width="100%",n.style.marginTop="12px",n.addEventListener("click",()=>function(e){if(r){if(!e){if(state.enchantPoints<20)return void b(`Not enough Enchantment Points! You need 20 EP but only have ${state.enchantPoints} EP.`);state.enchantPoints-=20}state.petRerollsUsed[r]||(state.petRerollsUsed[r]=0),state.petRerollsUsed[r]++,saveState(),u(),x()}else b("Please select a pet first")}(t)),i.appendChild(n)}()}function b(e){return new Promise(t=>{const n=document.createElement("div");n.style.position="fixed",n.style.left="0",n.style.top="0",n.style.right="0",n.style.bottom="0",n.style.background="rgba(0,0,0,0.45)",n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.zIndex="9999";const s=document.createElement("div");s.style.width="min(420px, 92%)",s.style.background="var(--modal-bg, #1f2937)",s.style.color="var(--modal-fg, #fff)",s.style.borderRadius="10px",s.style.boxShadow="0 8px 24px rgba(0,0,0,0.35)",s.style.padding="18px",s.style.display="flex",s.style.flexDirection="column",s.style.gap="12px";const o=document.createElement("div");o.style.fontSize="15px",o.style.lineHeight="1.4",o.style.color="var(--modal-fg, #fff)",o.textContent=e;const i=document.createElement("div");i.style.display="flex",i.style.justifyContent="flex-end";const l=document.createElement("button");function c(){document.body.removeChild(n),document.removeEventListener("keydown",a),t()}function a(e){"Escape"===e.key&&c()}l.textContent="OK",l.style.padding="8px 14px",l.style.borderRadius="8px",l.style.border="none",l.style.cursor="pointer",l.style.background="var(--accent, #3b82f6)",l.style.color="white",i.appendChild(l),s.appendChild(o),s.appendChild(i),n.appendChild(s),document.body.appendChild(n),l.addEventListener("click",c),n.addEventListener("click",e=>{e.target===n&&c()}),document.addEventListener("keydown",a)})}document.addEventListener("DOMContentLoaded",()=>{e=document.getElementById("enchantPoints"),t=document.getElementById("petGrid"),n=document.getElementById("selectedPetInfo"),s=document.getElementById("selectedPetName"),o=document.getElementById("selectedPetEnchants"),i=document.getElementById("enchantOptions"),l=document.getElementById("petSelectorModal"),c=document.getElementById("closePetSelector"),a=document.getElementById("petSelectorTitle"),d=document.getElementById("petInstanceList"),c&&c.addEventListener("click",E),l&&l.addEventListener("click",e=>{e.target===l&&E()}),state.petRerollsUsed||(state.petRerollsUsed={}),u()})}}]);